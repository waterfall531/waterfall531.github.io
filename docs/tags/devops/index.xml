<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>devops on Randy&#39;s Blog</title>
    <link>https://waterfall531.github.io/tags/devops/</link>
    <description>Recent content in devops on Randy&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-tw</language>
    <lastBuildDate>Mon, 02 Aug 2021 13:46:09 +0800</lastBuildDate><atom:link href="https://waterfall531.github.io/tags/devops/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Canary</title>
      <link>https://waterfall531.github.io/posts/canary/</link>
      <pubDate>Mon, 02 Aug 2021 13:46:09 +0800</pubDate>
      
      <guid>https://waterfall531.github.io/posts/canary/</guid>
      <description>發布  金絲雀(灰度) 滾動 藍綠  金絲雀  有n台 先更新一台 確定沒問題 直到更新完n台  滾動  有n台 先更新一台 直到更新完n台  藍綠  有2n台 先移出n台 更新n台 切換到新的n台  金絲雀+藍綠  有2n台 n台更新 陸續切換到新版本  功能開關  有n台 更新 用開關切換  A/B測試  有2n台 n台Ａ n台b  </description>
    </item>
    
    <item>
      <title>Nginx Conf</title>
      <link>https://waterfall531.github.io/posts/nginx-conf/</link>
      <pubDate>Thu, 10 Jun 2021 15:13:39 +0800</pubDate>
      
      <guid>https://waterfall531.github.io/posts/nginx-conf/</guid>
      <description>setDeny server { listen 443 ssl; server_name somewhere.com; if ($isDeny = 1) { return 403; } } set isDeny map $remote_addr $isApiDeny { 1.1.1.1 0; # 模擬代理 default 0; } 感覺接近 arrayMapping $remoteAddr === &amp;lsquo;1.1.1.1&amp;rsquo; 時 return 0
所以可以快速開關並且設定黑白名單
area 由於有時候可能要關掉地區 所以要借助 geoip
nginx http geoip2 module
http { ... geoip2 /etc/maxmind-country.mmdb { auto_reload 5m; $geoip2_metadata_country_build metadata build_epoch; $geoip2_data_country_code default=US source=$variable_with_ip country iso_code; $geoip2_data_country_name country names en; } geoip2 /etc/maxmind-city.mmdb { $geoip2_data_city_name default=London city names en; } .</description>
    </item>
    
    <item>
      <title>Dev Nginx</title>
      <link>https://waterfall531.github.io/posts/dev-nginx/</link>
      <pubDate>Thu, 10 Jun 2021 11:55:15 +0800</pubDate>
      
      <guid>https://waterfall531.github.io/posts/dev-nginx/</guid>
      <description>Nginx Install yum -y install gcc gcc-c++ autoconf automake make yum -y install zlib zlib-devel openssl openssl-devel pcre pcre-devel wget http://nginx.org/download/nginx-1.19.0.tar.gz tar xf nginx-1.19.0.tar.gz cd nginx-1.19.0 groupadd -f nginx useradd -g nginx nginx ./configure --user=nginx --group=nginx --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-stream --with-http_gzip_static_module --with-http_sub_module make &amp;amp;&amp;amp; make install start cd /usr/local/nginx/ sbin/nginx -t #nginx: the configuration file /usr/local/nginx/conf/nginx.conf syntax is ok #nginx: configuration file /usr/local/nginx/conf/nginx.conf test is successful /usr/local/nginx/sbin/nginx ps aux | grep nginx check netstat -tnlp Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 0.</description>
    </item>
    
    <item>
      <title>Dev Mariadb</title>
      <link>https://waterfall531.github.io/posts/dev-mysql-5-6/</link>
      <pubDate>Wed, 09 Jun 2021 11:34:06 +0800</pubDate>
      
      <guid>https://waterfall531.github.io/posts/dev-mysql-5-6/</guid>
      <description>getMariadb yum install mariadb-server active systemctl enable mariadb systemctl start mariadb init mysql_secure_installaion deBug cd /var/lib; rm -rf mysql; yum remove mariadb-server </description>
    </item>
    
    <item>
      <title>Dev Redis</title>
      <link>https://waterfall531.github.io/posts/dev-redis/</link>
      <pubDate>Wed, 09 Jun 2021 10:17:51 +0800</pubDate>
      
      <guid>https://waterfall531.github.io/posts/dev-redis/</guid>
      <description>install redis yum install wget gcc wget http://download.redis.io/releases/redis-5.0.3.tar.gz tar -zxvf redis-5.0.3.tar.gz cd redis-5.0.3 make install #test echo $? setup mkdir -p /usr/local/redis cp redis-benchmark redis-check-aof redis-check-rdb redis-cli redis -sentinel redis-server /usr/local/redis/ cp /root/redis-5.0.3/redis.conf /usr/local/redis/ cp /root/redis-5.0.3/sentinel.conf /usr/local/redis/ #test redis-server /usr/local/redis/redis.conf backup  RDB  依據時間/key值變化數量去做快照
AOF  依據每單位時間做的log
優點  RDB 還原快 數據量小 AOF 時間節點多
淘汰   有設定時間 *. 依據使用量 *. 靠近過期時間 *. 隨機
  無設定時間 *. 依據使用量 *.</description>
    </item>
    
    <item>
      <title>Dev Ssh</title>
      <link>https://waterfall531.github.io/posts/dev-ssh/</link>
      <pubDate>Tue, 08 Jun 2021 17:52:54 +0800</pubDate>
      
      <guid>https://waterfall531.github.io/posts/dev-ssh/</guid>
      <description>install yum install openssh openssh-server yum install policycoreutils-python yum install vim-enhanced -y yum install net-tools conf sshd vim /etc/ssh/sshd_config Port 2222 PermitRootLogin yes semanage port -a -t ssh_port_t -p tcp 2222 systemctl restart sshd.service firewall firewall-cmd -—permanent —-zone=public —-add-port=2222/tcp firewall-cmd —-reload SSH Key mkdir -p .ssh; exit; cat .ssh/id_rsa.pub | ssh root@192.168.183.50 &#39;cat &amp;gt;&amp;gt; .ssh/authorized_keys&#39; ssh -p 2222 root@192.168.183.50 chmod 700 .ssh; chmod 640 .ssh/authorized_keys vim /etc/ssh/sshd_config PermitRootLogin no </description>
    </item>
    
    <item>
      <title>Dev Svn</title>
      <link>https://waterfall531.github.io/posts/dev-svn/</link>
      <pubDate>Tue, 08 Jun 2021 17:30:54 +0800</pubDate>
      
      <guid>https://waterfall531.github.io/posts/dev-svn/</guid>
      <description>install sudo yum install subversion create repo cd /var; mkdir svn; sudo svnadmin create /var/svn/{$name} conf svnserve.conf anon-access = none / write / read auth-access = write / read / none password-db = passwd authz-db = authz realm = {$repoName} passwd [users] account = password authz [groups] #群組 = 帳號1,帳號2 admin = account tmp = tmp1,test2 [{$repoName}:/] @admin = rw [{$repoName}:/] $tmp = r service sudo svnserve -dr /var/svn #check ps aux|grep svnserve #firewall sudo firewall-cmd --permanent -add-port=3690/tcp sudo firewall-cmd --reload #123 sudo systemctl enable svnserve.</description>
    </item>
    
  </channel>
</rss>
